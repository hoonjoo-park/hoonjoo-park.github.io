<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>[React] Virtual DOM - Hoon&#039;s 블로그</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3273dc"><meta name="application-name" content="Hoon"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="msapplication-TileColor" content="#3273dc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hoon"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="DOM이란 무엇인가? 가상 DOM(Virtual DOM)을 이해하기 위해선, DOM이 무엇인지 먼저 확실하게 이해해야 한다."><meta property="og:type" content="blog"><meta property="og:title" content="[React] Virtual DOM"><meta property="og:url" content="https://hoonjoo-park.github.io/react/virtualDOM/"><meta property="og:site_name" content="Hoon&#039;s 블로그"><meta property="og:description" content="DOM이란 무엇인가? 가상 DOM(Virtual DOM)을 이해하기 위해선, DOM이 무엇인지 먼저 확실하게 이해해야 한다."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://user-images.githubusercontent.com/67448481/157859178-e1c7c737-0830-4c42-a85f-3f199076731b.png"><meta property="og:image" content="https://user-images.githubusercontent.com/67448481/157859155-6249cc1f-9a2e-40a5-8595-a862724647cc.png"><meta property="og:image" content="https://user-images.githubusercontent.com/67448481/157859163-20edeb58-0002-4bbd-951b-db1435a4e8a6.png"><meta property="og:image" content="https://user-images.githubusercontent.com/67448481/157859168-5b0ec171-3b60-4fa2-afc1-a3fe978cd327.png"><meta property="og:image" content="https://user-images.githubusercontent.com/67448481/157859172-1bd8c6ae-fca4-4648-94a6-553843416355.png"><meta property="og:image" content="https://user-images.githubusercontent.com/67448481/157859173-b17563c1-c8aa-44dc-b3dc-b7a5f35436b0.png"><meta property="og:image" content="https://user-images.githubusercontent.com/67448481/157859175-83df4121-195c-4bf7-9d2d-bcd05e884958.png"><meta property="article:published_time" content="2022-03-11T11:36:40.000Z"><meta property="article:modified_time" content="2022-03-11T11:35:16.624Z"><meta property="article:author" content="Hoonjoo"><meta property="article:tag" content="개념"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://user-images.githubusercontent.com/67448481/157859178-e1c7c737-0830-4c42-a85f-3f199076731b.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hoonjoo-park.github.io/react/virtualDOM/"},"headline":"[React] Virtual DOM","image":["https://user-images.githubusercontent.com/67448481/157859178-e1c7c737-0830-4c42-a85f-3f199076731b.png","https://user-images.githubusercontent.com/67448481/157859155-6249cc1f-9a2e-40a5-8595-a862724647cc.png","https://user-images.githubusercontent.com/67448481/157859163-20edeb58-0002-4bbd-951b-db1435a4e8a6.png","https://user-images.githubusercontent.com/67448481/157859168-5b0ec171-3b60-4fa2-afc1-a3fe978cd327.png","https://user-images.githubusercontent.com/67448481/157859172-1bd8c6ae-fca4-4648-94a6-553843416355.png","https://user-images.githubusercontent.com/67448481/157859173-b17563c1-c8aa-44dc-b3dc-b7a5f35436b0.png","https://user-images.githubusercontent.com/67448481/157859175-83df4121-195c-4bf7-9d2d-bcd05e884958.png"],"datePublished":"2022-03-11T11:36:40.000Z","dateModified":"2022-03-11T11:35:16.624Z","author":{"@type":"Person","name":"Hoonjoo"},"publisher":{"@type":"Organization","name":"Hoon's 블로그","logo":{"@type":"ImageObject","url":"https://hoonjoo-park.github.io/img/logo.svg"}},"description":"DOM이란 무엇인가? 가상 DOM(Virtual DOM)을 이해하기 위해선, DOM이 무엇인지 먼저 확실하게 이해해야 한다."}</script><link rel="canonical" href="https://hoonjoo-park.github.io/react/virtualDOM/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&amp;family=Roboto" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&amp;family=Roboto" rel="stylesheet"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-0RF6Y2B0CN" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-0RF6Y2B0CN');</script><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hoon&#039;s 블로그" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-9-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-11T11:36:40.000Z" title="2022. 3. 11. 오후 8:36:40">2022-03-11</time></span><span class="level-item"><a class="link-muted" href="/categories/%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C/">프론트엔드</a><span> / </span><a class="link-muted" href="/categories/%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C/React/">React</a></span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">[React] Virtual DOM</h1><div class="content"><p><img src="https://user-images.githubusercontent.com/67448481/157859178-e1c7c737-0830-4c42-a85f-3f199076731b.png"></p>
<h2 id="DOM이란-무엇인가"><a href="#DOM이란-무엇인가" class="headerlink" title="DOM이란 무엇인가?"></a>DOM이란 무엇인가?</h2><blockquote>
<p>가상 DOM(Virtual DOM)을 이해하기 위해선, <strong>DOM이 무엇인지 먼저 확실하게 이해</strong>해야 한다.</p>
</blockquote>
<p><strong>DOM</strong>(Document Object Model)은 우리가 작성한 <strong>HTML 코드가 브라우저에 의해 파싱되어 구조화 및 계층화 된 노드 트리</strong>다. 글만 봐서는 이해하기 힘든 것이 당연하기에 아래 HTML 코드를 봐보자.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My first web page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>How are you?<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>이처럼 우리가 작성한 HTML 코드가 DOM으로 표현되면 아래와 같을 것이다.각 노드들이 트리 형태로 연결되어 있는 모습이다. 브라우저는 이를 기반으로 페이지에 우리가 작성한 HTML코드를 표시해준다.</p>
<p><img src="https://user-images.githubusercontent.com/67448481/157859155-6249cc1f-9a2e-40a5-8595-a862724647cc.png" alt="DOM Tree"></p>
<h3 id="DOM을-쓰면-되지-굳이-왜…"><a href="#DOM을-쓰면-되지-굳이-왜…" class="headerlink" title="DOM을 쓰면 되지 굳이 왜…?"></a>DOM을 쓰면 되지 굳이 왜…?</h3><blockquote>
<p>DOM에 특별한 하자가 있는 것도 아닌데, 왜 우리는 가상 돔을 사용해야 하는 것일까?</p>
</blockquote>
<p>DOM을 조작(manipulate)하는 것에 대한 시간복잡도가 비효율적이기 때문이다. 다시 말해, DOM의 변화를 브라우저에 적용시키는 것이 굉장히 느리다. 물론, 확실하게 짚고 넘어가야 할 것이 있는데, <strong>DOM 자체의 조작이 느린 것은 아니다</strong>. DOM이 새로운 변동사항을 적용하여 최신화 되는 과정은 굉장히 빠르다. javascript가 이를 처리하기 때문이다. 하지만, 이러한 <strong>최신화된 DOM이 렌더트리가 되고, 다시 새롭게 배치 및 페이지 상에 그려지는 데에 시간이 오래걸리는 것이 더 정확한 표현</strong>일 것이다.</p>
<p><img src="https://user-images.githubusercontent.com/67448481/157859163-20edeb58-0002-4bbd-951b-db1435a4e8a6.png" alt="출처: bitsofcode, “What, exactly, is the DOM?”"></p>
<blockquote>
<p>즉, 위 사진에서 <strong>노란색 렌더트리 ~ 브라우저 렌더링 까지의 시간이 오래 걸린다</strong>는 것이다.</p>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/67448481/157859168-5b0ec171-3b60-4fa2-afc1-a3fe978cd327.png" alt="원본 DOM만 사용할 경우 (전체가 다시 렌더링 되어야 함)"></p>
<p><img src="https://user-images.githubusercontent.com/67448481/157859172-1bd8c6ae-fca4-4648-94a6-553843416355.png" alt="가상 DOM을 사용할 경우"></p>
<p>따라서, 우리는 <strong>원본 DOM만을 사용해서는 DOM의 변동사항을 브라우저에 효율적이고 빠르게 렌더링시키지 못한다.</strong> 이 블로그를 예로 들어, 댓글 하나만 추가됐을 뿐인데 전체 페이지를 다시 재배치하고 페인팅해야 한다면 어떨까? 굉장히 비효율적일 것이다. 따라서 우리가 기대하는 효율적인 렌더링은 <strong>“변화가 일어난”부분만 리렌더링 되는 것</strong>이다. (위 사진과 같이)</p>
<p>이 때문에 리액트에서는 <strong>자체적인 비교 알고리즘</strong>을 활용하여 이전 DOM과 최신 DOM 간의 비교를 통해 <strong>“변화가 일어난 부분”만 리렌더링 될 수 있도록 해준다(재조정).</strong> 이는 우리가 리액트를 사용하는 주된 이유 중 하나일 것이다. 그럼 이제 Virtual DOM이 무엇인지 알아보도록 하자.</p>
<hr>
<h2 id="Virtual-DOM이란"><a href="#Virtual-DOM이란" class="headerlink" title="Virtual DOM이란?"></a>Virtual DOM이란?</h2><blockquote>
<p>가상 DOM은 원본 DOM을 복제하여 메모리에 담아두고, 원본 DOM과 동기화 한 하나의 DOM이자 객체다.</p>
</blockquote>
<p>비유적으로 표현하면, 가상 DOM을 전자기기의 설계도라고 표현할 수도 있을 것 같다. 설계도가 변경된다고 해서 즉각적으로 원래 존재하던 전자기기의 설계가 변경되진 않는다. 설계도를 기반으로 전자기기를 재조립하거나 새로 만들어야 변경사항이 적용된다는 것이다. 이처럼 Virtual DOM 또한 즉각적이고 직접적으로 브라우저에 표시된 페이지를 변화시키진 못한다. 단지, 가상DOM과 가상DOM 간의 비교 알고리즘(diffing)을 통해 변동사항을 감지하고 원본 DOM에 변동사항을 적용시키는 것일 뿐이다.</p>
<p><strong>여기서 또 중요한 내용이 나온다. 가상 DOM과 가상 DOM의 비교다.</strong></p>
<p><img src="https://user-images.githubusercontent.com/67448481/157859173-b17563c1-c8aa-44dc-b3dc-b7a5f35436b0.png" alt="ntitled"></p>
<blockquote>
<p>“엥? 원본 DOM과 가상 DOM을 비교하는 것 아니었어?”</p>
</blockquote>
<p>부분적으로는 맞는 말일 수도 있다. 하지만 정확하게는 원본 DOM과 동일한 가상 DOM과 vs 변경사항이 적용된 가상 DOM 간의 비교가 이루어지는 것이다. <em>(물론 원본 가상DOM과 원본 DOM은 같기 때문에, 원본 DOM과 가상 DOM(변경사항이 적용된)의 비교라고 해도 큰 무리는 없을 것이지만 말이다.)</em></p>
<h3 id="그럼-Virtual-DOM은-어떻게-만들어질까"><a href="#그럼-Virtual-DOM은-어떻게-만들어질까" class="headerlink" title="그럼 Virtual DOM은 어떻게 만들어질까?"></a>그럼 Virtual DOM은 어떻게 만들어질까?</h3><blockquote>
<p>코드를 활용해 설명해보도록 하겠다.</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## 우리가 작성한 HTML 코드</span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;”itemList”&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>위 HTML 코드를 javascript를 통해 객체화 한다면 아래의 모습과 같다.</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 위의 HTML 코드를 DOM의 형태로 객체화</span></span><br><span class="line">&#123; <span class="attr">type</span>: <span class="string">&#x27;ul&#x27;</span>, <span class="attr">props</span>: &#123; <span class="string">&#x27;class&#x27;</span> : <span class="string">&#x27;itemList&#x27;</span> &#125;, <span class="attr">children</span>: [</span><br><span class="line">	&#123; <span class="attr">type</span>: <span class="string">&#x27;li&#x27;</span>, <span class="attr">props</span>: &#123;&#125;, <span class="attr">children</span>: [<span class="string">&#x27;item1&#x27;</span>] &#125;,</span><br><span class="line">	&#123; <span class="attr">type</span>: <span class="string">&#x27;li&#x27;</span>, <span class="attr">props</span>: &#123;&#125;, <span class="attr">children</span>: [<span class="string">&#x27;item2&#x27;</span>] &#125;</span><br><span class="line">] &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 즉, 하나의 node는 아래와 같은 형태를 갖는 것이다.</span></span><br><span class="line">&#123; <span class="attr">type</span>: ‘…’, <span class="attr">props</span>: &#123; … &#125;, <span class="attr">children</span>: [ … ] &#125;</span><br></pre></td></tr></table></figure>

<p>이를 jsx로 다시 코드를 짠 뒤, 바벨을 활용해 오브젝트 형태로 트랜스파일링 해준다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** <span class="doctag">@jsx </span>transpile */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 위의 주석 코드를 통해 바벨은 jsx코드를 아래 작성한 transpile함수에 맞게 트랜스파일링 해준다.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">transpile</span>(<span class="params">type, props, ...children</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; type, props, children &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 우리가 작성한 jsx 코드.</span></span><br><span class="line"><span class="keyword">const</span> newHTML = (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&#x27;list&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/67448481/157859175-83df4121-195c-4bf7-9d2d-bcd05e884958.png" alt="트랜스파일 된 jsx"></p>
<p>이제 트랜스파일 된 자바스크립트 오브젝트를 활용해 가상DOM으로써 활용해준다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** <span class="doctag">@jsx </span>transpile */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">transpile</span>(<span class="params">type, props, ...children</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; type, props, children &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newHTML = (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&#x27;list&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createElement</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(node);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> node === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">document</span>.createTextNode(node);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 최상단 node의 type은 &#x27;ul&#x27;이다.</span></span><br><span class="line">  <span class="keyword">const</span> $el = <span class="built_in">document</span>.createElement(node.type); <span class="comment">// ul</span></span><br><span class="line">  <span class="comment">// node.children = [...&#123;type:&#x27;&#x27;, props:&#123;&#125;, children:[...]&#125;] =&gt; 즉, item1, item2의 node다.</span></span><br><span class="line">  node.children</span><br><span class="line">    .map(<span class="function">(<span class="params">child</span>) =&gt;</span> createElement(child))</span><br><span class="line">    .forEach($el.appendChild.bind($el)); <span class="comment">// 각 하위 노드들이 차례대로 $el에 Child로써 어펜드 된다.</span></span><br><span class="line">  <span class="keyword">return</span> $el; <span class="comment">// 최종 DOM</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> $root = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">$root.appendChild(createElement(a));</span><br></pre></td></tr></table></figure>

<p>여기까지가 순수 자바스크립트를 활용해 Virtual DOM을 생성한 과정이다. <em>(물론 이는 단지 예시일 뿐, 리액트에서는 다른 방식으로 Virtual DOM을 생성하고 manipulating 할 것이다.)</em></p>
<h3 id="여하튼-Virtual-DOM을-통해-변경사항만-리렌더링-된다"><a href="#여하튼-Virtual-DOM을-통해-변경사항만-리렌더링-된다" class="headerlink" title="여하튼, Virtual DOM을 통해 변경사항만 리렌더링 된다."></a>여하튼, Virtual DOM을 통해 변경사항만 리렌더링 된다.</h3><blockquote>
<p>리액트는 DOM 엘리먼트의 타입, 속성(className, style 등)의 변동사항을 캐치하여 해당 타입 또는 속성만 갈아 끼워 넣어주기도 한다.</p>
</blockquote>
<p>뿐만 아니라, 엘리먼트의 내용(텍스트)이 변경된 경우에도 변경된 엘리먼트만 업데이트 한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>first<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>second<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>first<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>third<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span> <span class="comment">// 이 부분만 변경</span></span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>

<p>또한, 아래와 같이 새롭게 추가되거나 제거된 엘리먼트도 효율적으로 핸들링 한다.</p>
<blockquote>
<p>이는 first 엘리먼트는 같네? → second 엘리먼트도 같네? → 어 third는 없었는데 추가됐네?와 같이 순차적이고 선형적인 방식으로 비교가 진행된다.</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>first<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>second<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>first<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>second<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>third<span class="tag">&lt;/<span class="name">li</span>&gt;</span> // 추가</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>하지만 이런 경우는 어떨까?</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// old</span></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>apple<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>orange<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// new</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>grape<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>apple<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>orange<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>&lt;li&gt;apple&lt;/li&gt; ≠ &lt;li&gt;grape&lt;/li&gt;</code>, <code>&lt;li&gt;orange&lt;/li&gt; ≠ &lt;li&gt;apple&lt;/li&gt;</code>… 와 같은 식으로 비교(diffing)가 진행되기 때문에 상단에 grape만 추가됐을 뿐인데 모든 엘리먼트들이 업데이트되게 될 것이다.</p>
</blockquote>
<p>이러한 상황이 매우 크고 복잡한 엘리먼트에서 발생한다면 심각한 비효율성을 초래할 것이다. 따라서 이 때 활용되는 것이 <code>Keys</code>다.</p>
<h3 id="Keys"><a href="#Keys" class="headerlink" title="Keys"></a>Keys</h3><blockquote>
<p>리액트는 엘리먼트에 key 속성이 존재한다면, key를 기준으로 엘리먼트들을 비교한다.</p>
</blockquote>
<p>따라서 아래의 코드는 이제 apple과 orange에는 변동사항이 없는 것으로 판별될 것이다. 따라서 grape 엘리먼트의 추가만 변동사항으로 인식하여 트리를 업데이트 할 것이다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// old</span></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#x27;1&#x27;</span>&gt;</span>apple<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#x27;2&#x27;</span>&gt;</span>orange<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// new</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#x27;0&#x27;</span>&gt;</span>grape<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#x27;1&#x27;</span>&gt;</span>apple<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#x27;2&#x27;</span>&gt;</span>orange<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="정리-및-요약"><a href="#정리-및-요약" class="headerlink" title="정리 및 요약"></a>정리 및 요약</h2><p>가상 DOM은 원본 DOM의 조작 또는 변동사항이 일어날 경우, 전체 DOM이 다시 생성 및 재배치되는 비효율성을 방지하고자 활용되는 DOM이다. 가상DOM은 메모리에 저장되는 원본 DOM의 복제본이며, 리액트에서의 재조정 및 비교의 주체가 되어 변경사항만 선택적으로 리렌더링 될 수 있도록 한다. 즉, 가상 DOM은 변경사항이 생겼을 때, 전체 DOM이 리렌더링되는 것이 아닌, 변경사항만 적용되어 선택적 리렌더링이 될 수 있도록 하는 데 핵심적인 역할을 한다.</p>
<h3 id="세-줄-요약"><a href="#세-줄-요약" class="headerlink" title="세 줄 요약"></a>세 줄 요약</h3><ol>
<li>가상 DOM은 원본 DOM의 복제본이다.</li>
<li>가상 DOM과 비교알고리즘(diffing)을 통해 변경된 부분만 기존 DOM 트리에 업데이트 한다.</li>
<li>변경사항만 리렌더링 되기 때문에 훨씬 빠르고 효율적인 성능을 기대할 수 있다.</li>
</ol>
<hr>
<h2 id="참조한-자료"><a href="#참조한-자료" class="headerlink" title="참조한 자료"></a>참조한 자료</h2><p><a target="_blank" rel="noopener" href="https://medium.com/@deathmood/how-to-write-your-own-virtual-dom-ee74acc13060">How to write your own Virtual DOM</a></p>
<p><a target="_blank" rel="noopener" href="https://bitsofco.de/what-exactly-is-the-dom/">What, exactly, is the DOM?</a></p>
<p><a target="_blank" rel="noopener" href="https://dev.to/koolkishan/what-is-virtual-dom-how-virtual-dom-works-what-is-reconciliation-what-is-diffing-algorithm-what-makes-react-so-fast-327a">What is Virtual DOM? How Virtual DOM works ? What is Reconciliation ? What is diffing algorithm? What makes React so fast ?</a></p>
<p><a target="_blank" rel="noopener" href="https://ko.reactjs.org/docs/reconciliation.html">재조정 (Reconciliation) - React</a></p>
<hr>
</div><div class="article-licensing box"><div class="licensing-title"><p>[React] Virtual DOM</p><p><a href="https://hoonjoo-park.github.io/react/virtualDOM/">https://hoonjoo-park.github.io/react/virtualDOM/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Hoonjoo</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-03-11</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-03-11</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%EA%B0%9C%EB%85%90/">개념</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=61ccb08ffa9c81001d245598&amp;product=sticky-share-buttons" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/javascript/base/this/"><span class="level-item">Javascript와 This</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><script src="https://utteranc.es/client.js" repo="hoonjoo-park/hoonjoo-park.github.io" issue-term="pathname" label="🙋‍♂️" theme="github-light" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-3-tablet is-3-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#DOM이란-무엇인가"><span class="level-left"><span class="level-item">1</span><span class="level-item">DOM이란 무엇인가?</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#DOM을-쓰면-되지-굳이-왜…"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">DOM을 쓰면 되지 굳이 왜…?</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Virtual-DOM이란"><span class="level-left"><span class="level-item">2</span><span class="level-item">Virtual DOM이란?</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#그럼-Virtual-DOM은-어떻게-만들어질까"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">그럼 Virtual DOM은 어떻게 만들어질까?</span></span></a></li><li><a class="level is-mobile" href="#여하튼-Virtual-DOM을-통해-변경사항만-리렌더링-된다"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">여하튼, Virtual DOM을 통해 변경사항만 리렌더링 된다.</span></span></a></li><li><a class="level is-mobile" href="#Keys"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Keys</span></span></a></li></ul></li><li><a class="level is-mobile" href="#정리-및-요약"><span class="level-left"><span class="level-item">3</span><span class="level-item">정리 및 요약</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#세-줄-요약"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">세 줄 요약</span></span></a></li></ul></li><li><a class="level is-mobile" href="#참조한-자료"><span class="level-left"><span class="level-item">4</span><span class="level-item">참조한 자료</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hoon&#039;s 블로그" height="28"></a><p class="is-size-7"><span>&copy; 2022 Hoonjoo</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">총 방문자 <span id="busuanzi_value_site_uv"></span> 명</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hoonjoo-park"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>